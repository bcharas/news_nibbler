{"ts":1367456604476,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"//handles reading/parsing the entries from all user feeds\n\nfunction getFeedsFromMongo() {\n  if (fbUserID !== undefined) {\n    $.ajax({\n      type: \"get\",\n      url: \"/getFeeds/\" + fbUserID, \n      success: function(data) {\n        window.user_feeds = data[0].topics;\n        for (var i = 0; i < window.user_feeds.length; i++) {\n          window.user_feeds[i].connection = \n            new google.feeds.Feed(window.user_feeds[i].url);\n        }\n        post_subscriptions();\n        parse_all_feeds();\n        new_subscription_input(); \n      }\n    });\n  }\n}\n\n//parses current entries of user feeds, then calls to post them to feed page\n//changed name from load_all_feeds\nfunction parse_all_feeds(){\n\twindow.active_feeds = [];\n\n\twindow.num_feeds = window.user_feeds.length;\n\n\tvar first_feed_info = window.user_feeds[0];\n\tif (first_feed_info.ignore){\n\t\tparse_remaining_feeds(0);\n\t}\n\telse{\n\t\t//console.log(\"\\nloading: \" + first_feed_info.feed_name);\n\t\tvar first_feed = first_feed_info.connection;\n    console.log(\"First feed: \" + first_feed);\n\t\tfirst_feed.setNumEntries(4);\n\t\tvar load_contents = function(result){\n\t\t\t\t\t\t\t\t\t\tparse_feed_entries(result, 0);\n\t\t\t\t\t\t\t\t\t};\n\t\tfirst_feed.load(load_contents);\n\t}\n}\n\n//parses contents of a given feed\n//changed name from load_feed_contents\nfunction parse_feed_entries(result, feed_num){\n\tif (!result.error){\n\t\tvar feed_contents = [];\n\t\tvar feed_id = window.user_feeds[feed_num];\n\t\tfor (var i = 0; i < result.feed.entries.length; i++) {\t\n\t\t\tvar entry = result.feed.entries[i];\n\t\t\tentry.feed_src = feed_id;\n\t\t\tfeed_contents.push(entry);\n\t\t}\n\t\twindow.active_feeds.push(feed_contents);\n\t\tif ((window.all_feeds_loaded) && (!(window.has_published))){\n\t\t\twindow.has_published = true;\n\t\t\tpost_feeds();\n\t\t}\n\t\telse{\n\t\t\tparse_remaining_feeds(feed_num);\n\t\t}\n    }\n\telse{\n\t\tconsole.log(\"ERROR\");\n\t\t$(\"#current_src\").text(\"ERROR WHILE CONSTRUCTING FEED\");\n\t}\n}\n\n//parses any remaining unparsed feeds\n//changed name from load_next_feed\nfunction parse_remaining_feeds(feed_num){\n\tfeed_num++;\n\t//console.log(\"next feed num: \" + feed_num);\n\tif (feed_num >= window.num_feeds){\n\t\t//console.log(\"\\nall feeds loaded\");\n\t\twindow.all_feeds_loaded = true;\n\t\tpost_feeds();\n\t}\n\telse{\n\t\tvar feed_to_load = window.user_feeds[feed_num];\n\t\tif (feed_to_load.ignore){\n\t\t\tparse_remaining_feeds(feed_num);\n\t\t\treturn;\n\t\t}\n\t\telse{\n\t\t\t//console.log(\"\\nloading: \" + feed_to_load.feed_name);\n\t\t\tvar new_feed = feed_to_load.connection;\n\t\t\tnew_feed.setNumEntries(4);\n\t\t\tvar load_contents = function(result){\n\t\t\t\t\t\t\t\t\tparse_feed_entries(result, feed_num);\n\t\t\t\t\t\t\t\t};\n\t\t\tnew_feed.load(load_contents);\n\t\t\treturn;\n\t\t}\n\t}\n}\n\n//reloads feeds (more recent articles, updates for any changes in feeds)\n//changed name from rebuild_feeds\nfunction refresh_feeds(){\n\t//console.log(\"\\n\\nRESETING FEEDS...\");\n\t//window.this_feed_num = 0;\n\twindow.all_feeds_loaded = false;\n\twindow.has_published = false;\n\t$(\"#feed_box\").empty();\n\tparse_all_feeds();\n}\n"]],"start1":0,"start2":0,"length1":0,"length2":2930}]],"length":2930}
