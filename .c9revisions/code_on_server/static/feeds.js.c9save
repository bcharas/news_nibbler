{"ts":1367182968416,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"//handles loading, deleting, and adding (with validating) feeds\n\n//constructor for feed object\nfunction Feed(name, url){\n\tthis.feed_name = name;\n\tthis.feed_src = url;\n\tthis.connection = new google.feeds.Feed(url);\n\twindow.user_feeds.push(this);\n}\n\n//deletes an existing feed, then refreshes feeds/topics\nfunction delete_feed(name){\n\tfor (var i = 0; i < window.user_feeds.length; i++){\n\t\tvar feed = window.user_feeds[i];\n\t\tif (feed.feed_name == name){\n\t\t\twindow.user_feeds.splice(i, 1);\n\t\t\t//console.log(\"Feed '\" + name + \"' deleted successfully\");\n\t\t\trefresh_feeds();\n\t\t\tpost_subscriptions();\n\t\t\treturn;\n\t\t}\n\t}\t\t\t\n}\n\n//adds input feed if it is a new and valid rss feed\nfunction add_new_feed(name, url){\n\tif (!(is_unique_feed(name, url))){\n\t\tconsole.log(\"Requested feed uses occupied name or url\");\n\t\treturn;\n\t}\n\t\n\tvar connection = new google.feeds.Feed(url);\n\t\n\tvar attempt_to_load_feed = function(result){\n\t\t\t\t\t\t\t\t\tif (is_valid_rss_feed(result, name, url, connection)){\n\t\t\t\t\t\t\t\t\t\t\t\t$(\"#name_input\").val(\"\");\n\t\t\t\t\t\t\t\t\t\t\t\t$(\"#url_input\").val(\"\");\n\t\t\t\t\t\t\t\t\t\t\t\trefresh_feeds();\n\t\t\t\t\t\t\t\t\t\t\t\tpost_subscriptions();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t};\n\tconnection.load(attempt_to_load_feed);\n\t\n\t\n}\n\t\n//checks if user already subscribes to a given feed\nfunction is_unique_feed(name, url){\n\tfor (var i = 0; i < window.user_feeds.length; i++){\n\t\tvar feed = window.user_feeds[i];\n\t\tif (feed.feed_name == name){\n\t\t\tconsole.log(\"there is already a feed with that name!\");\n\t\t\treturn false;\n\t\t}\n\t\tif (feed.feed_src == url){\n\t\t\tconsole.log(\"You are already subscribed to this feed!\");\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\t\n\t\n//tries to load the contents of a given feed to see if valid feed\nfunction is_valid_rss_feed(result, name, url, connection){\n\tif (!result.error){\n\t\t//$(\"#name_input\").val(\"\");\n\t\t//$(\"#url_input\").val(\"\");\n\t\tsave_validated_feed(name, url, connection);\n\t\t//refresh_feeds();\n\t\t//post_subscriptions();\n\t\treturn true;\n\t}\n\telse{\t\n\t\tconsole.log(\"Invalid feed\");\n\t\treturn false;\n\t}\n}\t\n\n//takes in a feed that is known to be valid, and adds it to user's subscriptions\nfunction save_validated_feed(name, url, connection){\n\tvar new_feed = new Object();\n\tnew_feed.feed_name = name;\n\tnew_feed.feed_src = url\n\tnew_feed.connection = connection;\n\twindow.user_feeds.push(new_feed);\n}\n"]],"start1":0,"start2":0,"length1":0,"length2":2265}]],"length":2265}
