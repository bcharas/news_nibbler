{"ts":1367428990778,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var accessToken;\nvar signedRequest;\nvar response;\n  \nfunction handleStatusChange(response) {\n  document.body.className = response.authResponse ? 'connected' : 'not_connected';\n  if (response.authResponse) {\n    //updateUserInfo(response);\n  }\n}\n\nwindow.fbAsyncInit = function() {\n  FB.init({\n    appId      : '359071470879336', // App ID\n    channelUrl : 'http://newsnibbler.net/static/channel.html', // Channel File\n    status     : true, // check login status\n    cookie     : true, // enable cookies to allow the server to access the session\n    xfbml      : true  // parse XFBML\n  });\n\n  FB.getLoginStatus(function(response) {\n    if (response.status === 'connected') {\n      accessToken = response.authResponse.accessToken;\n      signedRequest = response.authResponse.signedRequest;\n      updateUserInfo(response);\n      $(\"#login_container\").addClass(\"hidden\");\n      $(\"#footer_container\").removeClass(\"hidden\");    \n      $(\"#feed_container\").removeClass(\"hidden\");\n    }\n    else {\n      //$(\"#login_container\").removeClass(\"hidden\");\n     // $(\"#footer_container\").addClass(\"hidden\");    \n     // $(\"#feed_container\").addClass(\"hidden\");\n    }\n  });\n\n  FB.Event.subscribe('auth.statusChange', handleStatusChange);\n\n};\n\n// Load the SDK Asynchronously\n(function(d){\n   var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];\n   if (d.getElementById(id)) {return;}\n   js = d.createElement('script'); js.id = id; js.async = true;\n   js.src = \"//connect.facebook.net/en_US/all.js\";\n   ref.parentNode.insertBefore(js, ref);\n}(document));\n\nfunction isAndroid(){\n    return navigator.userAgent.indexOf(\"Android\") !== -1;\n}\n\nfunction isIOS(){\n   return  !!(navigator.userAgent.match(/iPhone/i) ||\n           navigator.userAgent.match(/iPod/i) ||\n           navigator.userAgent.match(/iPad/i));\n}\n\nfunction loginUser() {\n  FB.getLoginStatus(function(response) {\n    if (response.status === 'connected') {\n      accessToken = response.authResponse.accessToken;\n      signedRequest = response.authResponse.signedRequest;\n      updateUserInfo(response);\n      $(\"#login_container\").addClass(\"hidden\");\n      $(\"#footer_container\").removeClass(\"hidden\");    \n      $(\"#feed_container\").removeClass(\"hidden\");\n    }\n    else {\n      console.log(\"NOT LOGGED IN\");\n      FB.login(function(response) { \n        if (response.authResponse !== null) {\n          accessToken = response.authResponse.accessToken;\n          updateUserInfo(response);\n          $(\"#login_container\").addClass(\"hidden\");\n          $(\"#footer_container\").removeClass(\"hidden\");    \n          $(\"#feed_container\").removeClass(\"hidden\");\n          //window.top.location = '/static/startScreens.html';\n          //console.log(window.top.location);\n        }\n      }, \n      {\n        scope:'email,user_likes,user_interests'\n      });     \n    }\n  });\n}\n\nfunction facebookLogout() {\n  FB.logout(function(response) {});\n}\n\nfunction updateUserInfo(response) {\n FB.api('/me', function(response) {\n   document.getElementById('profile_pic').innerHTML = '<img src=\"https://graph.facebook.com/' + response.id + '/picture\">';\n   document.getElementById('username').innerHTML = response.name;\n });\n}\n\nfunction getUserFriends() {\n  FB.api('/me/friends?fields=name,picture', function(response) {\n\n    if (!response.error) {\n      var markup = '';\n\n      var friends = response.data;\n\n      for (var i=0; i < friends.length && i < 25; i++) {\n         var friend = friends[i];\n\n         markup += '<img src=\"' + friend.picture.data.url + '\"> ' + friend.name + '<br>';\n      }\n      document.getElementById('user-friends').innerHTML = markup;\n    }\n  });\n}\n\nfunction getLikes() { \n FB.api('/me/likes?fields=name', function(response) {\n   console.log('Got likes: ', response);\n\n   if (!response.error) {\n     var markup = '';\n\n\n     var likes = response.data;\n      console.log(\"Likes:\", likes);\n\n     for (var i=0; i < likes.length && i < 25; i++) {\n       var like = likes[i];\n\n       markup +=  like.name + '<br>';\n     }\n\n     document.getElementById('user-likes').innerHTML = markup;\n   }\n });\n}\n\nfunction getInterests() { \n FB.api('/me/interests?fields=name', function(response) {\n   console.log('Got interests: ', response);\n\n   if (!response.error) {\n     var markup = '';\n\n\n     var interests = response.data;\n      console.log(\"Interests:\", interests);\n\n     for (var i=0; i < interests.length && i < 25; i++) {\n       var interest = interests[i];\n\n       markup +=  interest.name + '<br>';\n     }\n\n     document.getElementById('user-interests').innerHTML = markup;\n   }\n });\n}\n\n"]],"start1":0,"start2":0,"length1":0,"length2":4554}]],"length":4554}
{"contributors":[],"silentsave":false,"ts":1367431703010,"patch":[[{"diffs":[[0,"Info(response);\n"],[1,"      getUserFriends();\n"],[0,"      $(\"#login_"]],"start1":2053,"start2":2053,"length1":32,"length2":56},{"diffs":[[0,"friends[i];\n"],[1,"         var prof = \"<div class ='topic'>\""],[0,"\n         ma"]],"start1":3456,"start2":3456,"length1":24,"length2":66},{"diffs":[[0,"    "],[-1,"markup += '"],[1,"var pic = '<div class= \"pro_pic\" > "],[0,"<img"]],"start1":3516,"start2":3516,"length1":19,"length2":43},{"diffs":[[0,"l + '\"> "],[1,"</div> '\n         var name = '<div class= \"friend_name\">"],[0,"'"],[-1," "],[0,"+ friend"]],"start1":3591,"start2":3591,"length1":18,"length2":73},{"diffs":[[0,"riend.name +"],[-1," "],[0,"'<"],[-1,"br>';\n"],[1,"/div></div>'\n         prof.append(pic);\n         prof.append(name);\n         markup.append(prof);\n   "],[0,"      }\n    "]],"start1":3659,"start2":3659,"length1":33,"length2":127},{"diffs":[[0,"ntById('"],[-1,"user-"],[0,"friends'"]],"start1":3805,"start2":3805,"length1":21,"length2":16}]],"length":4788,"saved":false}
